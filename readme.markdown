# 实验二

## 一、总体设计框架：
我设计的框架是将三个任务汇总到一个总的jar包中执行，由输入时的参数来决定执行哪一个任务。
### 1、任务1：
Mapper读取输入数据，提取日期、资金流入量和资金流出量，将日期作为键，资金流入量和资金流出量作为值输出；Reducer汇总每个日期的资金流入量和资金流出量，输出日期及其对应的总资金流入量和总资金流出量。
### 2、任务2：
基于任务1的结果，统计一周七天中每天的平均资金流入与流出情况，并按照资金流入量从大到小排序。Mapper读取任务1的输出数据，提取日期、资金流入量和资金流出量;将日期转换为星期几，并将星期几作为键，资金流入量和资金流出量作为值输出。Reducer汇总每个星期几的资金流入量和资金流出量,计算每个星期几的平均资金流入量和资金流出量,输出星期几及其对应的平均资金流入量和平均资金流出量。
### 3、任务3：
Mapper读取输入数据，提取用户ID、直接购买量和总赎回量,判断用户是否在当天活跃（直接购买量或总赎回量大于0）,如果用户当天活跃，则将用户ID作为键，值为1输出;Reducer汇总每个用户的活跃天数,输出用户ID及其对应的活跃天数,并按照活跃天数降序排列。

## 二、程序运行结果：
![](屏幕截图%202024-11-14%20202842.png)
屏幕截图如上

输出结果见output文件夹。

## 三、实验中遇到的问题：
### 1、任务4没有找到很好的方法来完成
任务4我没有找到很好的代码方法来完成：（
### 2、在每次运行不同任务时需要手动规定输出路径，否则会出现output文件夹存在而导致mapreduce运行出错的情况。
### 3、未使用combiner,性能方面可能存在优化空间。
